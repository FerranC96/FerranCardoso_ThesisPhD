\chapter{Discussion and Future Perspectives}
\label{07disc}

\section{Building Accessible and Automated Tools for MC Data Analysis}

In this work I have shown CyGNAL's capabilities, describing in detail its design and inner mechanisms, and outlining its usefulness with regards to the analysis of \acrshort{mc} datasets.

The main testament for the usefulness of the tool is the fact that it has become a part of routine \acrshort{mc} analyses in our lab. With its support for plain text to FCS inter-compatibility (Chapter \ref{02methods} and Figure \ref{fig:3cygpipe}), users can seamlessly integrate with \acrshort{mc} platforms such as Cytobank. Given that the user only needs to run simple Python commands on the terminal to use CyGNAL, it has been readily adopted in day-to-day lab use even by users with no advanced computing experience. 
As I have shown in Chapters \ref{02methods} and \ref{03cytof}, CyGNAL is able to perform a comprehensive analysis of changes occurring across multiple conditions of the often wide \acrshort{mc} experimental systems. Designed for the study of \acrshort{ptm} signalling changes, CyGNAL's computation of \acrshort{emd} and \acrshort{dremi} scores resolves marker intensity and connectivity changes (Figure \ref{fig:3cyguse}). The intuitive and customisable interactive Shiny-Apps allow for exploratory and close to publication-grade visualisation of the results (Figure \ref{fig:3cygvis}). Tools are meant to be used, and that publications by colleagues such as Michelozzi \emph{et al}.~\cite{michelozzi_activation_2023} employed CyGNAL is a testament to its relevance.

Originally meant as a simple exercise in curiosity-driven exploration after noticing the correlation between so called PTM and 'cell-state' markers, and empowered by the tediousness of manually gating the datasets in our lab, the \acrshort{rf} cell-state classifier has become a convenient tool to automate cell-state labelling of \acrshort{mc} datasets in relation to cell-cycle phases.

Built around a simple \acrfull{rf} architecture, the \acrshort{rf} classifier benefits from the fundamental gate-like logic of both decision trees and the manual cell-state gating process (Figure \ref{fig:3classover}). However, I expect the classifier to suffer from generalisation issues when dealing with external data labelled using different workflows. Furthermore, even if it leverages fuzzy logic to match channel names from the model to the input data, the classifier still relies on matching markers found in both the training  and test datasets. While the markers dedicated to apoptosis and cell-cycle phases generally belong to the less variable portions of \acrshort{mc} panel design (Table \ref{tab:2rfmark}), this can still pose an inconvenience when deploying the model. However, I have also shown how weak points such as low performance for apoptotic class prediction using the 5-marker \acrshort{mc} model (Figure \ref{fig:3class5m}), can be effectively addressed by just the addition of an additional apoptotic marker to the panel design (Figure \ref{fig:3class5m}A). Furthermore, the model seems resilient to cell-type composition and even to broad cell-state changes induced by chemotherapy (Figure \ref{fig:3class5m}B-C).

Hearkening back to the link between \acrshort{ptm}s and cell-cycle, the 10-marker \acrshort{mc} model also reveals how certain \acrshort{ptm}s prove more informative when training than \emph{bona fide} 'cell-state' markers (Figure \ref{fig:2train}E). Furthermore, discrepancies between expected cell-state and \acrshort{ptm} correlations from the literature and feature importance rankings have anecdotally been used to validate under-performing antibodies with high unspecific background staining.

Both these tools remain under continuous support, and I aim to eventually merge both code bases and integrate automated cell-state classification into CyGNAL using pre-built classifier models or allowing for the generation of new models based on specific user-provided labelled data.
CyGNAL could also be augmented by the addition of PHATE~\cite{moon_visualizing_2019} as an alternative \acrshort{dr} step, implementing a new Shiny-App to visualise the embeddings and overlay user-selected metadata or antibody intensities.

\newpage
\section{Charting Stromal and Oncogenic Regulation of CSC Polarisation}

Single-cell technologies can describe cell-cell communications and cell-type transitions in complex organoid settings and \emph{in vivo} tissues~\cite{qin_deciphering_2020, jin_inference_2021, bues_deterministic_2022}. As shown in Qin \emph{et al.}~\cite{qin_cell-type-specific_2020}, a heterocellular colonic epithelia organoid system can be employed in experimental designs covering the effects of both intrinsic \acrshort{crc} oncogenic mutations and extrinsic environmental cues. However, the directed and limited nature of the \acrshort{mc} antibody panels used in Qin \emph{et al.}~\cite{qin_cell-type-specific_2020} presented with a limiting factor towards a detailed description of colonic organoid epithelial polarisation by intrinsic and extrinsic cues. 

Therefore, in Chapters \ref{04seq} and \ref{05vr} I have employed a multiplexed \acrshort{scrnaseq} analysis of heterocellular \acrshort{crc} organoid cultures (Figure \ref{fig:4exp}) to chart a continuous landscape of intrinsic and extrinsic regulation of \acrshort{csc} states. I have found that stromal cues transition the epithelia towards the \acrshort{revcsc} state, oncogenic signalling pushes the organoid towards \acrshort{procsc}, and exogenous ligands overlapping with both stromal and oncogenic signalling cues can polarise towards both states at once (Figure \ref{fig:4da}). I have also developed a method to capture these transitional processes, the \acrfull{vr} score (Figure \ref{fig:5score}), and established a workflow to project it onto Waddington-like data-driven landscapes (Figure \ref{fig:2land}). 
The work presented in this thesis was paired with complementary \acrshort{mc} experiments in Qin \& Cardoso Rodriguez \emph{et al.}~\cite{cardoso_rodriguez_single-cell_2023}, where we interrogated colonic stem cell regulation at scale to functionally understand the polarisation mechanisms (Appendix \ref{appendix:qincardoso}).

First, I have shown that transcriptomic profiles of epithelial, fibroblast and macrophage cells from the heterocellular cultures can be used to describe inter-type heterogeneity and recapitulate the distinct epithelial compartments (Figures \ref{fig:4exp} \& \ref{fig:4intepi}). 
The observed \emph{Cd34} high and low fibroblast populations are reminiscent of \emph{in situ} intestinal fibroblast heterogeneity, wherein \emph{Cd34} expressing fibroblast from the bottom of the crypts support the intestinal stem niche~\cite{stzepourginski_cd34_2017} whereas \emph{Cd34} low fibroblast are found above the crypt's bottoms and help maintain the BMP gradient needed for epithelial differentiation~\cite{karpus_colonic_2019}. While I observed some transcriptional differences between these two fibroblast populations (Sup. Figure \ref{fig:defib}), their regulation of the epithelial compartment remained consistent (Sup. Figure \ref{fig:deepibyfib}), possibly due to shared secreted signalling between the two. 
Myeloid macrophage transcriptomes formed a continuum trajectory of putative inflammation-related roles (Sup. Figure \ref{fig:demac}), unlike the distinct fibroblast and epithelial populations. However, neither macrophages as a whole nor the extremes of their transcriptional continuum differentially regulated the epithelial cells.

The healthy small intestinal and colonic epithelia is supported by a stem cell niche at the bottom of the crypts regulated by both intrinsic and stroma-secreted signalling gradients. These traditional \acrfull{csc} however, are not the sole stem cell state, with less common low-proliferative \acrfull{revcsc} being able to replenish the \acrshort{csc} niche and repair the epithelial tissue in response to tissue damage~\cite{ayyaz_single-cell_2019}. Here I have shown how these \acrshort{revcsc} are enriched by stromal WNT and TGF-\textbeta\hspace{0.1cm} when \acrshort{wt} organoids are co-cultured with fibroblasts (Figures \ref{fig:4da}A \& \ref{fig:4cc}B), and how \acrshort{revcsc} also resemble public descriptions of the same population and a “foetal"-like state~\cite{mustata_identification_2013} (Figure \ref{fig:4sign}A).

The gradient of organoids with accumulating oncogenic mutations revealed how a \acrfull{procsc} state is enriched in CRC organoids (Figure \ref{fig:4da}B). These cells are present in lower numbers in \acrshort{wt} and \textit{shApc} organoids, but quickly dominate the landscape of stunted absorptive and secretory differentiation in the \textit{shApc} and \textit{Kras\textsuperscript{G12D/+}} (AK), and \textit{shApc}, \textit{Kras\textsuperscript{G12D/+}} and \textit{Trp53\textsuperscript{R172H/–}} (AKP) colonic organoids (Figure \ref{fig:4da}C). \acrshort{procsc} were found to be transcriptionally similar to other cells from mouse models and human CRC (Figure \ref{fig:4sign}A).

With a clear differential regulation by extrinsic stromal cues and intrinsic oncogenic signalling, polarisation of \acrshort{wt} colonic epithelia towards both \acrshort{procsc} and \acrshort{revcsc} could nonetheless be achieved via exogenous WENR added to the culture media (Figure \ref{fig:4da}C). These findings, together with subsequent \acrshort{mc} validation~\cite{cardoso_rodriguez_single-cell_2023} of the signalling hubs identified via cell-cell communication analysis, suggest that both states are part of a shared polarisation landscape with overlapping signalling pathways that compete to establish colonic epithelial cell-fate.
In this context, the observed breakdown of fibroblast-to epithelia communications in CRC organoids (at least partly due to downregulation of key signalling receptors by the epithelial cells) seems to suggest that intrinsic oncogenic cues dominate extrinsic stromal cues (Figure \ref{fig:4cc}). The interplay between the two with regard to \acrshort{procsc} and \acrshort{revcsc} polarisation is explored further in Qin \& Cardoso Rodriguez \emph{et al.}~\cite{cardoso_rodriguez_single-cell_2023}, where we established that TGF-\textbeta\hspace{0.1cm} can induce \acrshort{revcsc}-like cells in CRC organoids in the context of low PI3K signalling, supporting the suggested role of \acrshort{revcsc} as a drug-resistant state in CRC that can drive relapse after chemotherapy~\cite{alvarez-varela_mex3a_2022, zapatero_trellis_2023}.

\emph{In silico} analysis of cellular dynamics identifies \acrshort{revcsc} as a terminal cell-fate (Figure \ref{fig:4dyn}E), suggesting that polarisation of the colonic epithelia towards \acrshort{revcsc} is achieved via plasticity-driven transitional processes from adjacent cell-states. In contrast, \acrshort{procsc} is consistently identified as an initial population (Figure \ref{fig:4dyn}) whose dominance of the epithelia seems to be achieved due to its high proliferative potential.

Therefore, I postulated that cellular pluripotency scores and rates of transcriptomic change could capture the cellular dynamics of such systems, providing for an avenue towards generation of data-driven Waddington-like landscapes of cellular differentiation and plasticity. The \acrfull{vr} score described in Chapter \ref{05vr} synthesises both CCAT and RNA velocity vector length metrics to capture coarse pluripotency changes and global transcriptomic structure with PHATE. Finer details at a local level capture the availability of cell-states as determined by RNA velocity (Figure \ref{fig:5score}). The methodology presented also incorporates with a landscape projection pipeline (Figure \ref{fig:2land}). The \acrshort{vr} landscapes reconstruct the shared landscape of colonic stem cell polarisation, presenting \acrshort{revcsc} as an accessible epithelial fate in the presence of stromal ligands, whereas intrinsic oncogenic signalling trap the organoid in a highly pluripotent yet isolated \acrshort{procsc} fate, refractory to stromal signals that otherwise would polarise the cells towards \acrshort{revcsc} (Figure \ref{fig:5land}). 

The work presented in these two chapters presents with some notable limitations, such as a lack of non-organoid \emph{in situ} validation: with the only effort towards validating the findings being achieved via \emph{in silico} signature matching and data integration (Figure \ref{fig:4sign}). Furthermore, non-paracrine stromal regulation, specially given the well-known role of fibroblasts as extra-cellular matrix re-modellers, has not been deeply explored in this study. It is also worth noting that a line of normal murine intestinal fibroblasts was used in the organoid co-cultures, rather than pairing the \acrshort{crc} organoids with cancer-associated fibroblasts. 
This later point will be addressed in subsequent studies at the lab by attempting to match patient-derived organoids with cancer-associated fibroblasts from the same donor. Further work regarding the cross-validation with human data of the \acrshort{procsc} and \acrshort{revcsc} cell identities and functional characteristics is being carried out as part of the peer-review process of the work presented in Qin \& Cardoso Rodriguez \emph{et al.}~\cite{cardoso_rodriguez_single-cell_2023}. Furthermore, additional improvements to the \acrshort{vr} score and landscape generation will be implemented during the later stages of my project. Aiming to increase the tool's accessibility and ease of use, the current Jupyter Notebook format will be adapted to the nbdev framework (\url{https://nbdev.fast.ai/}). \acrshort{vr} landscapes will be packaged as a tool, \emph{\acrshort{vr} Land} (\url{github.com/FerranC96/VRland}), which will be distributed as an interactive web-app to facilitate the exploration of the 3-dimensional landscapes generated.

In conclusion, these results describe fibroblasts as key stromal regulators of the colonic stem compartment, orientating epithelial stem cell fate via secreted WNT and TGF-\textbeta\hspace{0.1cm}. Stromal regulation competes with, and is ultimately trumped by, the \acrshort{procsc}-enriching organoid-intrinsic oncogenic cues. Further understanding concerning the regulation of \acrshort{procsc} and \acrshort{revcsc} fates might suggest new avenues for cancer therapies. Indeed, given that \acrshort{revcsc} has already been described as a drug-tolerant persister state~\cite{alvarez-varela_mex3a_2022}, blocking the plastic processes controlling its accessibility might be a valid strategy to limit the emergence of chemotherapy resistance. 


\newpage
\section{Knowledge Graphs for Cell Communication}

While cellular communications are commonly understood to be a complex process both at the inter- and intra-cellular levels, there is a lack of tools aiming to capture the causal and directed nature of the process. Coupled with emerging multi-modal approaches that could measure gene and protein expression, including \acrshort{ptm}s, methods capturing both paracrine secreted signalling and cell-state responses to extrinsic cues should describe a holistic view of cellular communications.

In Chapter \ref{06kg} I have assembled a directed and hierarchical \acrfull{lrtkg} from publicly available databases that aims to capture the cellular signalling occurring both between interacting cells and within a cell receiving extrinsic cues (Figure \ref{fig:6intro}). Aiming to apply this new method to study cell communications within the \acrshort{wt} organoid and fibroblast co-culture in a holistic manner, the assembled \acrshort{kg} has a complexity comparable to the curated OmniPath database (Figure \ref{fig:6kg}, Table \ref{tab:2kg}). Nonetheless, I have shown that knowledge graph embedding approaches can learn a simpler tabular representation of the \acrshort{kg} that conserves the biological information encoded within it; including relational information between the gene nodes regarding pathway annotations (Figure \ref{fig:6embed}). 

Using a wavelet-based diffusion step and projecting the \acrshort{scrnaseq} organoid co-culture data (Figures \ref{fig:2wav} \& \ref{fig:6project}), I have successfully shown that projected cellular profiles diffused on the \acrshort{kg} preserve the information encoded in the original transcriptomic data representation. However, the projected profiles appear to be too similar to the \acrfull{gex} data (Figure \ref{fig:6project}). Indeed, when inter-cluster distances are computed, no significant change was detected between the original and projected views; with fibroblasts and \acrshort{revcsc}s, found to be closely interacting by cell-cell communication, remaining at comparable proximity to their prior \acrshort{gex} profiles (Figure \ref{fig:6bench}).

Most likely explained by an insufficient diffusion process, alternative approaches are being explored in conjunction with my collaborators at Yale University; such as the work on directed scattering transforms presented at the Graph Signal Processing Workshop 2023 (\url{https://ferranc96.github.io/posts/GSPw23/}). With a robust diffusion process, the method performance could also be bench-marked by leveraging spatial data as done by alternative cell-cell communication approaches~\cite{fischer_modeling_2022}. Multi-modal data could also be projected on a modality-agnostic feature-feature \acrshort{kg} with both protein and gene nodes. This approach should be able to more confidently call inter-cellular interactions via ligand-receptor expression, and intra-cellular responses via \acrshort{ptm} profiles and expression of transcription factor targets.

In summary, a balance between limiting signal loss (determined by the nodes in the \acrshort{kg}) and adequate diffusion approaches (ensuring sufficient information on the graph structure itself is captured during data projection) is necessary for such a holistic cell communication method to perform adequately. It would appear then, that the current implementation requires of further work on the later point. Published approaches exist to tackle similar problems~\cite{lefebvre_large-scale_2021, yang_sctenifoldxct_2023}, but the aim of treating the cells as signals to be compared on a gene-gene graph (or other \emph{omic} features), remains to my knowledge unique to the efforts presented here and worth pursuing specially considering multi-modal profiles could be projected on such feature-feature \acrshort{kg}s. 
